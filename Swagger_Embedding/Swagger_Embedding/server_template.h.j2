/* AUTO-GENERATED BY GENERATOR.PY - DO NOT EDIT */
#pragma once
#include <esp_http_server.h>
#include "esp_log.h"

httpd_handle_t swagger_server = NULL;

{% for path, methods in paths.items() -%}
    {% for method, info in methods.items() -%}
        {% if info.operationId %}
// Prototype
esp_err_t swagger_{{ info.operationId }}(httpd_req_t *req);

// Stub Implementation (Weak) will need to be replaced by user
__attribute__((weak)) inline esp_err_t swagger_{{ info.operationId }}(httpd_req_t *req) {
    ESP_LOGW("REST_API", "Stub called: {{ info.operationId }} not implemented!");
    httpd_resp_send_err(req, HTTPD_501_METHOD_NOT_IMPLEMENTED, "Endpoint not implemented yet");
    return ESP_OK;
}
        {%- endif %}
    {%- endfor %}
{%- endfor %}

esp_err_t start_swagger_rest_server()
{
    {% for path, methods in paths.items() -%}
    {%- for method, info in methods.items() -%}
    {% if info.operationId %}
    /* URI handler for {{path}} */
    httpd_uri_t swagger_{{info.operationId}}_uri = {
        .uri = "{{ path }}",
        .method = {% if method=="get"%}HTTP_GET{% elif method=="post"%}HTTP_POST{% endif %},
        .handler = swagger_{{info.operationId}},
        .user_ctx = NULL
    };
    httpd_register_uri_handler(swagger_server, &swagger_{{info.operationId}}_uri);
    {% endif -%}
    {% endfor -%}
    {% endfor -%}
    return ESP_OK;
}
